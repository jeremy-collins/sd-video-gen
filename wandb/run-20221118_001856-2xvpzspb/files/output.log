device:  cuda
loading VAE...
loading VAE...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:00<00:00, 11.48it/s]
 11%|███████████████████████████▍                                                                                                                                                                                                                           | 1/9 [00:00<00:04,  1.76it/s]
Number of training samples:  10340
TRAIN DATASET
3
torch.Size([5, 64, 64, 3])
------------------------- Epoch 1 -------------------------
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:00<00:00, 12.70it/s]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]/home/jcollins90/sd-video-gen/trainer.py:130: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  new_batch = torch.tensor(new_batch).to(self.device)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:05<00:00,  2.76s/it]
  0%|                                                                                                                                                                                                                                                               | 0/1 [00:00<?, ?it/s]/home/jcollins90/sd-video-gen/trainer.py:177: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  new_batch = torch.tensor(new_batch).to(self.device)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.31s/it]
Training loss: 1.8515
Validation loss: 1.4912
model saved as config_test_2.pt
------------------------- Epoch 2 -------------------------
Training and validating model

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.42s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.5162
Validation loss: 1.3312
model saved as config_test_2.pt
------------------------- Epoch 3 -------------------------

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.34s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.30s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.4215
Validation loss: 1.2766
model saved as config_test_2.pt
------------------------- Epoch 4 -------------------------

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.36s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.32s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.3736
Validation loss: 1.1612
model saved as config_test_2.pt
------------------------- Epoch 5 -------------------------

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.36s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.2898
Validation loss: 1.1272
model saved as config_test_2.pt
------------------------- Epoch 6 -------------------------

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.39s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.31s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.2386
Validation loss: 1.1471
------------------------- Epoch 7 -------------------------
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.35s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.29s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.1907
Validation loss: 1.0526
model saved as config_test_2.pt
------------------------- Epoch 8 -------------------------

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.34s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.43s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.1785
Validation loss: 1.0424
model saved as config_test_2.pt
------------------------- Epoch 9 -------------------------
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.35s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.46s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.1422
Validation loss: 1.0694
------------------------- Epoch 10 -------------------------
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.38s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.32s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.1272
Validation loss: 1.1377
------------------------- Epoch 11 -------------------------

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.38s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.40s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.1026
Validation loss: 1.0420
model saved as config_test_2.pt
------------------------- Epoch 12 -------------------------
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.41s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.45s/it]
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]
Training loss: 1.0604
Validation loss: 1.0012
model saved as config_test_2.pt
------------------------- Epoch 13 -------------------------
  0%|                                                                                                                                                                                                                                                               | 0/2 [00:00<?, ?it/s]Error in sys.excepthook:
Traceback (most recent call last):
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/linecache.py", line 137, in updatecache
    lines = fp.readlines()
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/codecs.py", line 319, in decode
    def decode(self, input, final=False):
KeyboardInterrupt
Original exception was:
Traceback (most recent call last):
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/wandb/agents/pyagent.py", line 220, in _run_jobs_from_queue
    thread.join()
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/threading.py", line 1089, in join
    self._wait_for_tstate_lock()
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/threading.py", line 1109, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/jcollins90/sd-video-gen/trainer.py", line 483, in <module>
    wandb.agent(sweep_id, lambda: main(args))
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/wandb/wandb_agent.py", line 639, in agent
    return pyagent(sweep_id, function, entity, project, count)
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/wandb/agents/pyagent.py", line 348, in pyagent
    agent.run()
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/wandb/agents/pyagent.py", line 326, in run
    self._run_jobs_from_queue()
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/wandb/agents/pyagent.py", line 264, in _run_jobs_from_queue
    wandb.termlog("Ctrl + C detected. Stopping sweep.")
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/wandb/errors/term.py", line 39, in termlog
    _log(
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/wandb/errors/term.py", line 95, in _log
    click.echo(line, file=sys.stderr, nl=newline)
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/click/utils.py", line 299, in echo
    file.write(out)  # type: ignore
  File "/nethome/jcollins90/miniconda3/envs/ls_project/lib/python3.10/site-packages/wandb/sdk/lib/redirect.py", line 640, in write
    self._old_write(data)
KeyboardInterrupt